üö® –ö–û–ú–ê–ù–î–ò –î–õ–Ø –í–ò–ö–û–ù–ê–ù–ù–Ø –ù–ê –°–ï–†–í–ï–†–Ü (—á–µ—Ä–µ–∑ SSH —è–∫ root)
========================================================

–ö–†–û–ö 1: –í–ò–ü–†–ê–í–ò–¢–ò SSL –î–õ–Ø g-shop.com.ua
----------------------------------------
# –í–∏–¥–∞–ª–∏—Ç–∏ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç–Ω—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é g-shop.info
rm -f /etc/nginx/vhosts/pashland/g-shop.info.conf

# –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ Nginx
nginx -t && systemctl reload nginx

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –ø—Ä–∞—Ü—é—î g-shop.com.ua
curl -I https://g-shop.com.ua/


–ö–†–û–ö 2: –í–°–¢–ê–ù–û–í–ò–¢–ò STRAPI –î–õ–Ø g-shop.info
------------------------------------------
cd /var/www/pashland/data/www/g-shop.info

# –û–Ω–æ–≤–∏—Ç–∏ –∫–æ–¥
git pull origin main

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ Strapi
cd backend
npm install @strapi/strapi@4.25.13 --save
npm install @strapi/plugin-users-permissions@4.25.13 --save
npm install @strapi/plugin-i18n@4.25.13 --save
npm install @strapi/plugin-cloud@4.25.13 --save

# –ü–æ–±—É–¥—É–≤–∞—Ç–∏
npm run build

cd ..


–ö–†–û–ö 3: –ó–ê–ü–£–°–¢–ò–¢–ò g-shop.info
------------------------------
# –ó—É–ø–∏–Ω–∏—Ç–∏ —Å—Ç–∞—Ä—ñ –ø—Ä–æ—Ü–µ—Å–∏
pkill -f "node.*g-shop.info" || true

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —á–µ—Ä–µ–∑ ISPManager Node.js
su - pashland -c "cd /var/www/pashland/data/www/g-shop.info && /var/www/pashland/data/.nvm/versions/node/v18.20.8/bin/node app.js > /tmp/strapi.log 2>&1 &"

# –ê–ë–û —á–µ—Ä–µ–∑ PM2
su - pashland -c "/usr/lib/ispnodejs/bin/pm2 delete g-shop.info 2>/dev/null"
su - pashland -c "/usr/lib/ispnodejs/bin/pm2 start /var/www/pashland/data/www/g-shop.info/app.js --name g-shop.info"
su - pashland -c "/usr/lib/ispnodejs/bin/pm2 save"


–ö–†–û–ö 4: –ü–ï–†–ï–í–Ü–†–ö–ê
-----------------
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—Ä–æ—Ü–µ—Å–∏
ps aux | grep node | grep g-shop

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ PM2
su - pashland -c "/usr/lib/ispnodejs/bin/pm2 status"

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ API
curl http://localhost:3002/api/products

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏
tail -f /tmp/strapi.log

========================================================
–ì–û–¢–û–í–û! –°–∞–π—Ç–∏ –º–∞—é—Ç—å –ø—Ä–∞—Ü—é–≤–∞—Ç–∏.